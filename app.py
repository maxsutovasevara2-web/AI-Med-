import streamlit as st

st.set_page_config(page_title="AI –ú–µ–¥-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç", page_icon="ü©∫", layout="centered")

st.title("ü©∫ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –º–µ–¥-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç: —Ä–∞–Ω–Ω–µ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø–Ω–µ–≤–º–æ–Ω–∏–∏")
st.write("""
–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –≠—Ç–æ—Ç –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ–º–æ–≥–∞–µ—Ç **–æ—Ü–µ–Ω–∏—Ç—å —Ä–∏—Å–∫ –ø–Ω–µ–≤–º–æ–Ω–∏–∏** –∏ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–µ–π—Å—Ç–≤–∏—è–º.  
‚ö†Ô∏è –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è **–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π** –∏ –Ω–µ –∑–∞–º–µ–Ω—è—é—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—Ä–∞—á–∞.
""")

# === 0. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ===
if "risk" not in st.session_state:
    st.session_state.risk = 0
if "severity" not in st.session_state:
    st.session_state.severity = "–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ"
if "recommendation" not in st.session_state:
    st.session_state.recommendation = "–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Å–∏–º–ø—Ç–æ–º–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ '–û—Ü–µ–Ω–∏—Ç—å —Ä–∏—Å–∫'."

# === 1. –í–≤–æ–¥ —Å–∏–º–ø—Ç–æ–º–æ–≤ ===
st.header("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ —Å–∏–º–ø—Ç–æ–º—ã")
with st.form("symptom_form"):
    temp_high = st.checkbox("–£ –≤–∞—Å –≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (–±–æ–ª–µ–µ 38¬∞C)?")
    cough = st.checkbox("–ï—Å—Ç—å –ª–∏ –∫–∞—à–µ–ª—å?")
    breath = st.checkbox("–¢—Ä—É–¥–Ω–æ –ª–∏ –¥—ã—à–∞—Ç—å?")
    chest_pain = st.checkbox("–ë–æ–ª—å –≤ –≥—Ä—É–¥–∏?")
    fatigue = st.checkbox("–°–ª–∞–±–æ—Å—Ç—å –∏–ª–∏ —É—Å—Ç–∞–ª–æ—Å—Ç—å?")
    submit = st.form_submit_button("–û—Ü–µ–Ω–∏—Ç—å —Ä–∏—Å–∫")

# === 2. –õ–æ–≥–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–∞ –∏ —Ç—è–∂–µ—Å—Ç–∏ ===
def evaluate_risk(temp_high, cough, breath, chest_pain, fatigue):
    risk = 0
    if temp_high: risk += 30
    if cough: risk += 25
    if breath: risk += 25
    if chest_pain: risk += 10
    if fatigue: risk += 10

    risk = min(risk, 100)

    if risk < 30:
        severity = "–õ—ë–≥–∫–∞—è"
        recommendation = "–°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å–∏–º–ø—Ç–æ–º–∞–º–∏ –¥–æ–º–∞, –æ—Ç–¥—ã—Ö–∞–π—Ç–µ, –ø–µ–π—Ç–µ –≤–æ–¥—É. –ú–æ–∂–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –æ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏–ª–∏ –∫–∞—à–ª—è."
    elif risk < 60:
        severity = "–°—Ä–µ–¥–Ω—è—è"
        recommendation = "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –≤—Ä–∞—á—É –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è."
    else:
        severity = "–¢—è–∂—ë–ª–∞—è"
        recommendation = "–°—Ä–æ—á–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≤—Ä–∞—á—É –∏–ª–∏ –≤—ã–∑–æ–≤–∏—Ç–µ —Å–∫–æ—Ä—É—é –ø–æ–º–æ—â—å!"

    return risk, severity, recommendation

# === 3. –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ session_state –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã ===
if submit:
    st.session_state.risk, st.session_state.severity, st.session_state.recommendation = evaluate_risk(
        temp_high, cough, breath, chest_pain, fatigue
    )

# === 4. –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ===
st.header("üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏")
st.write(f"**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–Ω–µ–≤–º–æ–Ω–∏–∏:** {st.session_state.risk}%")
st.write(f"**–¢—è–∂–µ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è:** {st.session_state.severity}")
st.write(f"**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** {st.session_state.recommendation}")

# === 5. –ß–∞—Ç-–±–æ—Ç –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏–π ===
st.header("ü§ñ –í–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç —Å AI")
user_question = st.text_input("–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ —Å–≤–æ–∏—Ö —Å–∏–º–ø—Ç–æ–º–∞—Ö:")

if user_question:
    if st.session_state.risk == 0:
        st.write("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Å–∏–º–ø—Ç–æ–º–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ '–û—Ü–µ–Ω–∏—Ç—å —Ä–∏—Å–∫'.")
    else:
        response_lines = []
        if temp_high:
            response_lines.append("- –í—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–æ–∑–º–æ–∂–Ω—É—é –∏–Ω—Ñ–µ–∫—Ü–∏—é.")
        if cough:
            response_lines.append("- –ö–∞—à–µ–ª—å ‚Äî –æ–¥–∏–Ω –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π.")
        if breath:
            response_lines.append("- –û–¥—ã—à–∫–∞ –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ –ª—ë–≥–∫–∏—Ö.")
        if chest_pain:
            response_lines.append("- –ë–æ–ª—å –≤ –≥—Ä—É–¥–∏ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è.")
        if fatigue:
            response_lines.append("- –°–ª–∞–±–æ—Å—Ç—å –∏ —É—Å—Ç–∞–ª–æ—Å—Ç—å —á–∞—Å—Ç–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—é—Ç –∏–Ω—Ñ–µ–∫—Ü–∏–∏.")
        
        if not response_lines:
            response_lines.append("–°–∏–º–ø—Ç–æ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —É–∫–∞–∑–∞–ª–∏, –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ø–Ω–µ–≤–º–æ–Ω–∏–∏, –Ω–æ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.")

        response_lines.append(f"–û–±—â–∏–π —Ä–∏—Å–∫: {st.session_state.risk}%, —Ç—è–∂–µ—Å—Ç—å: {st.session_state.severity}.")
        response_lines.append(f"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: {st.session_state.recommendation}")

        st.write("–ù–∞ –æ—Å–Ω–æ–≤–µ –≤–≤–µ–¥—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:\n" + "\n".join(response_lines))
